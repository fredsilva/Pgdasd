# -*_ encoding; ytf-8 -*-
'''
Created on 16/04/2013

@author: Frederico da Silva Santos
@email: fredsilva.sistemas@gmail.com
'''
from db import oracle

class PgdasdController():
    '''
    Manipula conexões e acessos ao banco de dados
    '''        
    
    def insert(self, pgdasd):
        '''
        Grava o registros do arquivo importado no Banco de Dados
        '''
        conn   = oracle.ConnectionOracle()
        conn   = conn.connect()
        cursor = conn.cursor()                
        
        #try:            
               
        cursor.execute('''INSERT INTO siatdesv.pgdasd(PGDASD_00000_ID_DECLARACAO, pgdasd_00000_num_recibo, pgdasd_00000_num_autenticacao, pgdasd_00000_dt_transmissao, pgdasd_00000_versao, pgdasd_00000_cnpjmatriz, pgdasd_00000_nome, pgdasd_00000_cod_tom, pgdasd_00000_optante, pgdasd_00000_abertura, pgdasd_00000_pa, pgdasd_00000_rpa, pgdasd_00000_razao, pgdasd_00000_im, pgdasd_00000_operacao, pgdasd_00000_regime, pgdasd_00000_rpac, pgdasd_00000_rpa_int, pgdasd_00000_rpa_ext)
        VALUES(:ID_Declaracao, :Num_Recibo, :Num_Autenticacao, :Dt_Transmissao, :Versao, :Cnpjmatriz, :Nome, :Cod_TOM, :Optante, :Abertura, :PA, :Rpa, :Razao, :IM, :Operacao, :Regime, :RpaC, :Rpa_Int, :Rpa_Ext)''',
         {'ID_Declaracao':pgdasd.Pgdasd_00000_ID_Declaracao, 'Num_Recibo':pgdasd.Pgdasd_00000_Num_Recibo, 'Num_Autenticacao':pgdasd.Pgdasd_00000_Num_Autenticacao, 'Dt_Transmissao':pgdasd.Pgdasd_00000_Dt_Transmissao, 'Versao':pgdasd.Pgdasd_00000_Versao, 'Cnpjmatriz':pgdasd.Pgdasd_00000_Cnpjmatriz, 'Nome':pgdasd.Pgdasd_00000_Nome, 'Cod_TOM':pgdasd.Pgdasd_00000_Cod_TOM, 'Optante':pgdasd.Pgdasd_00000_Optante, 'Abertura':pgdasd.Pgdasd_00000_Abertura, 'PA':pgdasd.Pgdasd_00000_PA, 'Rpa':pgdasd.Pgdasd_00000_Rpa, 'Razao':pgdasd.Pgdasd_00000_Razao, 'IM':pgdasd.Pgdasd_00000_IM, 'Operacao':pgdasd.Pgdasd_00000_Operacao, 'Regime':pgdasd.Pgdasd_00000_Regime, 'RpaC':pgdasd.Pgdasd_00000_RpaC, 'Rpa_Int':pgdasd.Pgdasd_00000_Rpa_Int, 'Rpa_Ext':pgdasd.Pgdasd_00000_Rpa_Ext})
        
        cursor.execute('''INSERT INTO siatdesv.pgdasd_01000(PGDASD_00000_ID_DECLARACAO, pgdasd_01000_nrpagto, pgdasd_01000_princ, pgdasd_01000_multa, pgdasd_01000_juros, pgdasd_01000_tdevido, pgdasd_01000_dtvenc, pgdasd_01000_dtvalcalc, pgdasd_01000_vdas)
        VALUES(:ID_Declaracao, :Nrpagto, :Princ, :Multa, :Juros, :Tdevido, :Dtvenc, :Dtvalcalc, :Vdas)''',
        {'ID_Declaracao':pgdasd.Pgdasd_00000_ID_Declaracao, 'Nrpagto':pgdasd.Pgdasd_01000.Nrpagto, 'Princ':pgdasd.Pgdasd_01000.Princ, 'Multa':pgdasd.Pgdasd_01000.Multa, 'Juros':pgdasd.Pgdasd_01000.Juros, 'Tdevido':pgdasd.Pgdasd_01000.Tdevido, 'Dtvenc':pgdasd.Pgdasd_01000.Dtvenc, 'Dtvalcalc':pgdasd.Pgdasd_01000.Dtvalcalc, 'Vdas':pgdasd.Pgdasd_01000.Vdas})
                
        for lista in pgdasd.Pgdasd_01500:                               
            cursor.execute('''INSERT INTO siatdesv.pgdasd_01500(PGDASD_00000_ID_DECLARACAO, pgdasd_01500_rbsn_pa, pgdasd_01500_rbsn_valor)
            VALUES(:ID_Declaracao, :rbsn_PA, :rbsn_valor)''',
            {'ID_Declaracao':pgdasd.Pgdasd_00000_ID_Declaracao, 'rbsn_PA':lista['rbsn_PA'], 'rbsn_valor':lista['rbsn_valor']})
            
        for lista in pgdasd.Pgdasd_01501:                
            cursor.execute('''INSERT INTO siatdesv.pgdasd_01501(PGDASD_00000_ID_DECLARACAO, pgdasd_01501_rbsn_pa, pgdasd_01501_rbsn_valor)
            VALUES(:ID_Declaracao, :rbsn_PA, :rbsn_valor)''',
            {'ID_Declaracao':pgdasd.Pgdasd_00000_ID_Declaracao, 'rbsn_PA':lista['rbsn_PA'], 'rbsn_valor':lista['rbsn_valor']})
            
        for lista in pgdasd.Pgdasd_01502:            
            cursor.execute('''INSERT INTO siatdesv.pgdasd_01502(PGDASD_00000_ID_DECLARACAO, pgdasd_01502_rbsn_ext_pa, pgdasd_01502_rbsn_ext_valor)
            VALUES(:ID_Declaracao, :Rbsn_Ext_PA, :Rbsn_Ext_valor)''',
            {'ID_Declaracao':pgdasd.Pgdasd_00000_ID_Declaracao, 'Rbsn_Ext_PA':lista['Rbsn_Ext_PA'], 'Rbsn_Ext_valor':lista['Rbsn_Ext_valor']})
            
            
        cursor.execute('''INSERT INTO siatdesv.pgdasd_02000(PGDASD_00000_ID_DECLARACAO, pgdasd_02000_id, pgdasd_02000_rbt12, pgdasd_02000_rbtaa, pgdasd_02000_rba, pgdasd_02000_rbt12o, pgdasd_02000_rbtaao, pgdasd_02000_icms, pgdasd_02000_iss, pgdasd_02000_rbtaa_int, pgdasd_02000_rbtaa_into, pgdasd_02000_rbtaa_ext, pgdasd_02000_rbtaa_exto)
        VALUES(:ID_Declaracao, :Id, :rbt12, :Rbtaa, :Rba, :rbt12o, :Rbtaao, :ICMS, :ISS, :Rbtaa_Int, :Rbtaa_Into, :Rbtaa_Ext, :Rbtaa_Exto)''',
        {'ID_Declaracao': pgdasd.Pgdasd_00000_ID_Declaracao, 'Id':pgdasd.Pgdasd_02000.Id, 'rbt12':pgdasd.Pgdasd_02000.rbt12, 'Rbtaa':pgdasd.Pgdasd_02000.Rbtaa, 'Rba':pgdasd.Pgdasd_02000.Rba, 'rbt12o':pgdasd.Pgdasd_02000.rbt12o, 'Rbtaao':pgdasd.Pgdasd_02000.Rbtaao, 'ICMS':pgdasd.Pgdasd_02000.ICMS, 'ISS':pgdasd.Pgdasd_02000.ISS, 'Rbtaa_Int':pgdasd.Pgdasd_02000.Rbtaa_Int, 'Rbtaa_Into':pgdasd.Pgdasd_02000.Rbtaa_Into, 'Rbtaa_Ext':pgdasd.Pgdasd_02000.Rbtaa_Ext, 'Rbtaa_Exto':pgdasd.Pgdasd_02000.Rbtaa_Exto})
            
            
        for lista in pgdasd.Pgdasd_03000:    
            cursor.execute('''INSERT INTO siatdesv.pgdasd_03000(PGDASD_00000_ID_DECLARACAO, pgdasd_03000_cnpj, pgdasd_03000_uf, pgdasd_03000_cod_tom, pgdasd_03000_vltotal, pgdasd_03000_ime, pgdasd_03000_limite, pgdasd_03000_limultrapassadopa, pgdasd_03000_prex1, pgdasd_03000_prex2)
            VALUES(:ID_Declaracao, :CNPJ, :Uf, :Cod_TOM, :Vltotal, :IME, :Limite, :LimUltrapassadoPA, :prex1, :prex2)''',
            {'ID_Declaracao': pgdasd.Pgdasd_00000_ID_Declaracao, 'CNPJ': lista['CNPJ'], 'Uf':lista['Uf'], 'Cod_TOM':lista['Cod_TOM'], 'Vltotal':lista['Vltotal'], 'IME':lista['IME'], 'Limite': lista['Limite'], 'LimUltrapassadoPA': lista['LimUltrapassadoPA'], 'prex1':lista['prex1'], 'prex2':lista['prex2']})        
        
        i = 0            
        for lista_03100 in pgdasd.Pgdasd_03100:                           
            
            cursor.execute('''INSERT INTO siatdesv.pgdasd_03100(PGDASD_00000_ID_DECLARACAO, pgdasd_03000_cnpj, pgdasd_03100_tipo, pgdasd_03100_vltotal)
            VALUES(:ID_Declaracao, :CNPJ, :Tipo, :Vltotal)''',
            {'ID_Declaracao':pgdasd.Pgdasd_00000_ID_Declaracao, 'CNPJ':pgdasd.Pgdasd_03000[0].get('CNPJ'), 'Tipo':lista_03100['Tipo'],'Vltotal':lista_03100['Vltotal']})            
                                                
            for lista in pgdasd.Pgdasd_03110: # Está violando constraint
                #print(pgdasd.Pgdasd_03100[i].get('Tipo'))                                               
                cursor.execute('''INSERT INTO siatdesv.pgdasd_03110(PGDASD_00000_ID_DECLARACAO, pgdasd_03000_cnpj, pgdasd_03100_tipo, pgdasd_03110_uf, pgdasd_03110_cod_tom, pgdasd_03110_valor, pgdasd_03110_cofins, pgdasd_03110_csll, pgdasd_03110_icms, pgdasd_03110_inss, pgdasd_03110_ipi, pgdasd_03110_irpj, pgdasd_03110_iss, pgdasd_03110_pis, pgdasd_03110_aliqapur, pgdasd_03110_vlimposto, pgdasd_03110_aliquota_cofins, pgdasd_03110_valor_cofins, pgdasd_03110_aliquota_csll, pgdasd_03110_valor_csll, pgdasd_03110_aliquota_icms, pgdasd_03110_valor_icms, pgdasd_03110_aliquota_inss, pgdasd_03110_valor_inss, pgdasd_03110_aliquota_ipi, pgdasd_03110_valor_ipi, pgdasd_03110_aliquota_irpj, pgdasd_03110_valor_irpj, pgdasd_03110_aliquota_iss, pgdasd_03110_valor_iss, pgdasd_03110_aliquota_pis, pgdasd_03110_valor_pis, pgdasd_03110_diferenca, pgdasd_03110_maiortributo)
                VALUES(:ID_Declaracao, :CNPJ, :Tipo, :UF, :Cod_TOM, :Valor, :COFINS, :CSLL, :ICMS, :INSS, :IPI, :IRPJ, :ISS, :PIS, :Aliqapur, :Vlimposto, :Aliquota_COFINS, :Valor_COFINS, :Aliquota_CSLL, :Valor_CSLL, :Aliquota_ICMS, :Valor_ICMS, :Aliquota_INSS, :Valor_INSS, :Aliquota_IPI, :Valor_IPI, :Aliquota_IRPJ, :Valor_IRPJ, :Aliquota_ISS, :Valor_ISS, :Aliquota_PIS, :Valor_PIS, :Diferenca, :Maiortributo)''',
                {'ID_Declaracao':pgdasd.Pgdasd_00000_ID_Declaracao, 'CNPJ':pgdasd.Pgdasd_03000[0].get('CNPJ'), 'Tipo':pgdasd.Pgdasd_03100[i].get('Tipo'), 'UF':lista['UF'], 'Cod_TOM':lista['Cod_TOM'], 'Valor':lista['Valor'], 'COFINS':lista['COFINS'], 'CSLL':lista['CSLL'], 'ICMS':lista['ICMS'], 'INSS':lista['INSS'], 'IPI':lista['IPI'], 'IRPJ':lista['IRPJ'], 'ISS':lista['ISS'], 'PIS':lista['PIS'], 'Aliqapur':lista['Aliqapur'], 'Vlimposto':lista['Vlimposto'], 'Aliquota_COFINS':lista['Aliquota_COFINS'], 'Valor_COFINS':lista['Valor_COFINS'], 'Aliquota_CSLL':lista['Aliquota_CSLL'], 'Valor_CSLL':lista['Valor_CSLL'], 'Aliquota_ICMS':lista['Aliquota_ICMS'], 'Valor_ICMS':lista['Valor_ICMS'], 'Aliquota_INSS':lista['Aliquota_INSS'], 'Valor_INSS':lista['Valor_INSS'], 'Aliquota_IPI':lista['Aliquota_IPI'], 'Valor_IPI':lista['Valor_IPI'], 'Aliquota_IRPJ':lista['Aliquota_IRPJ'], 'Valor_IRPJ':lista['Valor_IRPJ'], 'Aliquota_ISS':lista['Aliquota_ISS'], 'Valor_ISS':lista['Valor_ISS'], 'Aliquota_PIS':lista['Aliquota_PIS'], 'Valor_PIS':lista['Valor_PIS'], 'Diferenca':lista['Diferenca'],'Maiortributo':lista['Maiortributo']})            
            i += 1                
        #cursor.execute('''INSERT INTO siatdesv.pgdasd_03111(PGDASD_00000_ID_DECLARACAO, pgdasd_03000_cnpj, pgdasd_03100_tipo, pgdasd_03110_id, pgdasd_03111_id, pgdasd_03111_aliqapur, pgdasd_03111_vlimposto, pgdasd_03111_aliquota_cofins, pgdasd_03111_valor_cofins, pgdasd_03111_aliquota_csll, pgdasd_03111_valor_csll, pgdasd_03111_aliquota_icms, pgdasd_03111_valor_icms, pgdasd_03111_aliquota_inss, pgdasd_03111_valor_inss, pgdasd_03111_aliquota_ipi, pgdasd_03111_valor_ipi, pgdasd_03111_aliquota_irpj, pgdasd_03111_valor_irpj, pgdasd_03111_aliquota_iss, pgdasd_03111_valor_iss, pgdasd_03111_aliquota_pis, pgdasd_03111_valor_pis, pgdasd_03111_diferenca, pgdasd_03111_maiortributo)
        #VALUES(:ID_Declaracao, :CNPJ, :Tipo, :03110_Id, :Id, :Aliqapur, :Vlimposto, :Aliquota_COFINS, :Valor_COFINS, :Aliquota_CSLL, :Valor_CSLL, :Aliquota_ICMS, :Valor_ICMS, :Aliquota_INSS, :Valor_INSS, :Aliquota_IPI, :Valor_IPI, :Aliquota_IRPJ, :Valor_IRPJ, :Aliquota_ISS, :Valor_ISS, :Aliquota_PIS, :Valor_PIS, :Diferenca, :Maiortributo)''',
        #{'ID_Declaracao':pgdasd.Pgdasd_00000_ID_Declaracao, 'CNPJ':pgdasd.Pgdasd_03000[0].get('CNPJ'), 'Tipo':pgdasd.Pgdasd_03100[0].get('Tipo'), '03110_Id':'1', 'Id':pgdasd.Pgdasd_03111.Id, 'Aliqapur':pgdasd.Pgdasd_03111.Aliqapur, 'Vlimposto':pgdasd.Pgdasd_03111.Vlimposto, 'Aliquota_COFINS':pgdasd.Pgdasd_03111.Aliquota_COFINS, 'Valor_COFINS':pgdasd.Pgdasd_03111.Valor_COFINS, 'Aliquota_CSLL':pgdasd.Pgdasd_03111.Aliquota_CSLL, 'Valor_CSLL':pgdasd.Pgdasd_03111.Valor_CSLL,'Aliquota_ICMS':pgdasd.Pgdasd_03111.Aliquota_ICMS, 'Valor_ICMS':pgdasd.Pgdasd_03111.Valor_ICMS, 'Aliquota_INSS':pgdasd.Pgdasd_03111.Aliquota_INSS, 'Valor_INSS':pgdasd.Pgdasd_03111.Valor_INSS, 'Aliquota_IPI':pgdasd.Pgdasd_03111.Aliquota_IPI, 'Valor_IPI':pgdasd.Pgdasd_03111.Valor_IPI, 'Aliquota_IRPJ':pgdasd.Pgdasd_03111.Aliquota_IRPJ, 'Valor_IRPJ':pgdasd.Pgdasd_03111.Valor_IRPJ, 'Aliquota_ISS':pgdasd.Pgdasd_03111.Aliquota_ISS, 'Valor_ISS':pgdasd.Pgdasd_03111.Valor_ISS, 'Aliquota_PIS':pgdasd.Pgdasd_03111.Aliquota_PIS, 'Valor_PIS':pgdasd.Pgdasd_03111.Valor_PIS, 'Diferenca':pgdasd.Pgdasd_03111.Diferenca,'Maiortributo':pgdasd.Pgdasd_03111.Maiortributo})
        
        #print(pgdasd.Pgdasd_03112.Id)
        #cursor.execute('''INSERT INTO siatdesv.pgdasd_03112(PGDASD_00000_ID_DECLARACAO, pgdasd_03000_cnpj, pgdasd_03100_tipo, pgdasd_03110_id, pgdasd_03112_id, pgdasd_03112_valor, pgdasd_03112_red, pgdasd_03112_aliqapur, pgdasd_03112_vlimposto, pgdasd_03112_aliquota_cofins, pgdasd_03112_valor_cofins, pgdasd_03112_aliquota_csll, pgdasd_03112_valor_csll, pgdasd_03112_aliquota_icms, pgdasd_03112_valor_icms, pgdasd_03112_aliquota_inss, pgdasd_03112_valor_inss, pgdasd_03112_aliquota_ipi, pgdasd_03112_valor_ipi, pgdasd_03112_aliquota_irpj, pgdasd_03112_valor_irpj, pgdasd_03112_aliquota_iss, pgdasd_03112_valor_iss, pgdasd_03112_diferenca, pgdasd_03112_maiortributo, pgdasd_03112_valor_pis, pgdasd_03112_aliquota_pis) 
        #VALUES(:ID_Declaracao, :CNPJ, :Tipo, :03110_Id, :Id, :valor, :red, :aliqapur, :vlimposto, :aliquota_cofins, :valor_cofins, :aliquota_csll, :valor_csll, :aliquota_icms, :valor_icms, :aliquota_inss, :valor_inss, :aliquota_ipi, :valor_ipi, :aliquota_irpj, :valor_irpj, :aliquota_iss, :valor_iss, :diferenca, :maiortributo, :valor_pis, :aliquota_pis)''',
        #{'ID_Declaracao':pgdasd.Pgdasd_00000_ID_Declaracao, 'CNPJ':pgdasd.Pgdasd_03000[0].get('CNPJ'), 'Tipo':pgdasd.Pgdasd_03100[0].get('Tipo'), '03110_Id':20, 'Id':pgdasd.Pgdasd_03112.Id, 'valor':pgdasd.Pgdasd_03112.Valor, 'red':pgdasd.Pgdasd_03112.Red, 'aliqapur':pgdasd.Pgdasd_03112.Aliqapur, 'vlimposto':pgdasd.Pgdasd_03112.Vlimposto,'aliquota_cofins':pgdasd.Pgdasd_03112.Aliquota_COFINS,'valor_cofins':pgdasd.Pgdasd_03112.Valor_COFINS, 'aliquota_csll':pgdasd.Pgdasd_03112.Aliquota_CSLL, 'valor_csll':pgdasd.Pgdasd_03112.Valor_CSLL, 'aliquota_icms':pgdasd.Pgdasd_03112.Aliquota_ICMS, 'valor_icms':pgdasd.Pgdasd_03112.Valor_ICMS, 'aliquota_inss':pgdasd.Pgdasd_03112.Aliquota_INSS, 'valor_inss':pgdasd.Pgdasd_03112.Valor_INSS, 'aliquota_ipi':pgdasd.Pgdasd_03112.Aliquota_IPI, 'valor_ipi':pgdasd.Pgdasd_03112.Valor_IPI, 'aliquota_irpj':pgdasd.Pgdasd_03112.Aliquota_IRPJ, 'valor_irpj':pgdasd.Pgdasd_03112.Valor_IRPJ,'aliquota_iss':pgdasd.Pgdasd_03112.Aliquota_ISS, 'valor_iss':pgdasd.Pgdasd_03112.Valor_ISS, 'diferenca':pgdasd.Pgdasd_03112.Diferenca, 'maiortributo':pgdasd.Pgdasd_03112.Maiortributo, 'valor_pis':pgdasd.Pgdasd_03112.Valor_PIS, 'aliquota_pis':pgdasd.Pgdasd_03112.Aliquota_PIS})

        #for lista in pgdasd.Pgdasd_03120:
        #    cursor.execute('''INSERT INTO siatdesv.pgdasd_03120(PGDASD_00000_ID_DECLARACAO, pgdasd_03000_cnpj, pgdasd_03100_tipo, pgdasd_03120_id, pgdasd_03120_aliqapur, pgdasd_03120_aliquota_cofins, pgdasd_03120_valor_cofins, pgdasd_03120_aliquota_csll, pgdasd_03120_valor_csll, pgdasd_03120_aliquota_icms, pgdasd_03120_valor_icms, pgdasd_03120_aliquota_inss, pgdasd_03120_valor_inss, pgdasd_03120_aliquota_ipi, pgdasd_03120_valor_ipi, pgdasd_03120_aliquota_irpj, pgdasd_03120_valor_irpj, pgdasd_03120_aliquota_iss, pgdasd_03120_valor_iss, pgdasd_03120_aliquota_pis, pgdasd_03120_valor_pis) 
        #    VALUES(:ID_Declaracao, :CNPJ, :Tipo, :Id, :Aliqapur, :Aliquota_COFINS, :Valor_COFINS, :Aliquota_CSLL, :Valor_CSLL, :Aliquota_ICMS, :Valor_ICMS, :Aliquota_INSS, :Valor_INSS, :Aliquota_IPI, :Valor_IPI, :Aliquota_IRPJ, :Valor_IRPJ, :Aliquota_ISS, :Valor_ISS, :Aliquota_PIS, :Valor_PIS)''',
        #    {'ID_Declaracao':pgdasd.Pgdasd_00000_ID_Declaracao, 'CNPJ':pgdasd.Pgdasd_03000[0].get('CNPJ'), 'Tipo':pgdasd.Pgdasd_03100[0].get('Tipo'), 'Id':lista['Id'], 'Aliqapur':lista['Aliqapur'], 'Aliquota_COFINS':lista['Aliquota_COFINS'], 'Valor_COFINS':lista['Valor_COFINS'], 'Aliquota_CSLL':lista['Aliquota_CSLL'], 'Valor_CSLL':lista['Aliquota_CSLL'], 'Aliquota_ICMS':lista['Aliquota_ICMS'], 'Valor_ICMS':lista['Valor_ICMS'], 'Aliquota_INSS':lista['Aliquota_INSS'], 'Valor_INSS':lista['Valor_INSS'], 'Aliquota_IPI':lista['Aliquota_IPI'], 'Valor_IPI':lista['Valor_IPI'], 'Aliquota_IRPJ':lista['Aliquota_IRPJ'], 'Valor_IRPJ':lista['Valor_IRPJ'], 'Aliquota_ISS':lista['Aliquota_ISS'], 'Valor_ISS':lista['Valor_ISS'], 'Aliquota_PIS':lista['Aliquota_PIS'],'Valor_PIS':lista['Valor_PIS']})
            

        #cursor.execute('''INSERT INTO siatdesv.pgdasd_03121(PGDASD_00000_ID_DECLARACAO, pgdasd_03000_cnpj, pgdasd_03100_tipo, pgdasd_03120_id, pgdasd_03121_id, pgdasd_03121_aliqapur, pgdasd_03121_aliquota_cofins, pgdasd_03121_valor_cofins, pgdasd_03121_aliquota_csll, pgdasd_03121_valor_csll, pgdasd_03121_aliquota_icms, pgdasd_03121_valor_icms, pgdasd_03121_aliquota_inss, pgdasd_03121_valor_inss, pgdasd_03121_aliquota_ipi, pgdasd_03121_valor_ipi, pgdasd_03121_aliquota_irpj, pgdasd_03121_valor_irpj, pgdasd_03121_aliquota_iss, pgdasd_03121_valor_iss, pgdasd_03121_aliquota_pis, pgdasd_03121_valor_pis) 
        #VALUES(:ID_Declaracao, :CNPJ, :Tipo, :03120_Id, :Id, :Aliqapur, :Aliquota_COFINS, :Valor_COFINS, :Aliquota_CSLL, :Valor_CSLL, :Aliquota_ICMS, :Valor_ICMS, :Aliquota_INSS, :Valor_INSS, :Aliquota_IPI, :Valor_IPI, :Aliquota_IRPJ, :Valor_IRPJ, :Aliquota_ISS, :Valor_ISS, :Aliquota_PIS, :Valor_PIS)''',
        #{'ID_Declaracao':pgdasd.Pgdasd_00000_ID_Declaracao, 'CNPJ':pgdasd.Pgdasd_03000.CNPJ, 'Tipo':pgdasd.Pgdasd_03000.Pgdasd_03100.Tipo, '03120_Id':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03120.Id, 'Id':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03120.Pgdasd_03121.Id, 'Aliqapur':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03120.Pgdasd_03121.Aliquota_COFINS, 'Valor_COFINS':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03120.Pgdasd_03121.Valor_COFINS, 'Aliquota_CSLL':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03120.Pgdasd_03121.Aliquota_CSLL, 'Valor_CSLL': pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03120.Pgdasd_03121.Valor_CSLL, 'Aliquota_ICMS':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03120.Pgdasd_03121.Aliquota_ICMS, 'Valor_ICMS':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03120.Pgdasd_03121.Valor_ICMS, 'Aliquota_INSS':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03120.Pgdasd_03121.Aliquota_INSS, 'Valor_INSS':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03120.Pgdasd_03121.Valor_INSS, 'Aliquota_IPI':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03120.Pgdasd_03121.Aliquota_IPI, 'Valor_IPI':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03120.Pgdasd_03121.Valor_IPI, 'Aliquota_IRPJ':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03120.Pgdasd_03121.Aliquota_IRPJ, 'Valor_IRPJ':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03120.Pgdasd_03121.Valor_IRPJ, 'Aliquota_ISS':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03120.Pgdasd_03121.Aliquota_ISS, 'Valor_ISS':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03120.Pgdasd_03121.Valor_ISS, 'Aliquota_PIS':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03120.Pgdasd_03121.Aliquota_PIS, 'Valor_PIS':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03120.Pgdasd_03121.Valor_PIS})
            
        #cursor.execute('''INSERT INTO siatdesv.pgdasd_03122(PGDASD_00000_ID_DECLARACAO, pgdasd_03000_cnpj, pgdasd_03100_tipo, pgdasd_03120_id, pgdasd_03122_id, pgdasd_03122_aliqapur, pgdasd_03122_aliquota_cofins, pgdasd_03122_valor_cofins, pgdasd_03122_aliquota_csll, pgdasd_03122_valor_csll, pgdasd_03122_aliquota_icms, pgdasd_03122_valor_icms, pgdasd_03122_aliquota_inss, pgdasd_03122_valor_inss, pgdasd_03122_aliquota_ipi, pgdasd_03122_valor_ipi, pgdasd_03122_aliquota_irpj, pgdasd_03122_valor_irpj, pgdasd_03122_aliquota_iss, pgdasd_03122_valor_iss, pgdasd_03122_aliquota_pis, pgdasd_03122_valor_pis)
        #VALUES(:ID_Declaracao, :CNPJ, :Tipo, :03120_Id, :Id, :Aliqapur, :Aliquota_COFINS, :Valor_COFINS, :Aliquota_CSLL, :Valor_CSLL, :Aliquota_ICMS, :Valor_ICMS, :Aliquota_INSS, :Valor_INSS, :Aliquota_IPI, :Valor_IPI, :Aliquota_IRPJ, :Valor_IRPJ, :Aliquota_ISS, :Valor_ISS, :Aliquota_PIS, :Valor_PIS)''',
        #{'ID_Declaracao':pgdasd.Pgdasd_00000_ID_Declaracao, 'CNPJ':pgdasd.Pgdasd_03000.CNPJ, 'Tipo':pgdasd.Pgdasd_03000.Pgdasd_03100.Tipo, '03120_Id':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03120.Id, 'Id':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03120.Pgdasd_03122.Id, 'Aliqapur':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03120.Pgdasd_03122.Aliqapur, 'Aliquota_COFINS':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03120.Pgdasd_03122.Aliquota_COFINS, 'Valor_COFINS':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03120.Pgdasd_03122.Valor_COFINS, 'Aliquota_CSLL':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03120.Pgdasd_03122.Aliquota_CSLL, 'Valor_CSLL':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03120.Pgdasd_03122.Valor_CSLL, 'Aliquota_ICMS':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03120.Pgdasd_03122.Aliquota_ICMS, 'Valor_ICMS':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03120.Pgdasd_03122.Valor_ICMS, 'Aliquota_INSS':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03120.Pgdasd_03122.Aliquota_INSS, 'Valor_INSS':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03120.Pgdasd_03122.Valor_INSS, 'Aliquota_IPI':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03120.Pgdasd_03122.Aliquota_IPI, 'Valor_IPI':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03120.Pgdasd_03122.Valor_IPI, 'Aliquota_IRPJ':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03120.Pgdasd_03122.Aliquota_IRPJ, 'Valor_IRPJ':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03120.Pgdasd_03122.Valor_IRPJ, 'Aliquota_ISS':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03120.Pgdasd_03122.Aliquota_ISS, 'Valor_ISS':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03120.Pgdasd_03122.Valor_ISS, 'Aliquota_PIS':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03120.Pgdasd_03122.Aliquota_PIS, 'Valor_PIS':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03120.Pgdasd_03122.Valor_PIS})
        
        for lista in pgdasd.Pgdasd_03130:    
            cursor.execute('''INSERT INTO siatdesv.pgdasd_03130(PGDASD_00000_ID_DECLARACAO, pgdasd_03000_cnpj, pgdasd_03100_tipo, pgdasd_03130_id, pgdasd_03130_aliqapur, pgdasd_03130_aliquota_cofins, pgdasd_03130_valor_cofins, pgdasd_03130_aliquota_csll, pgdasd_03130_valor_csll, pgdasd_03130_aliquota_icms, pgdasd_03130_valor_icms, pgdasd_03130_aliquota_inss, pgdasd_03130_valor_inss, pgdasd_03130_aliquota_ipi, pgdasd_03130_valor_ipi, pgdasd_03130_aliquota_irpj, pgdasd_03130_valor_irpj, pgdasd_03130_aliquota_iss, pgdasd_03130_valor_iss, pgdasd_03130_aliquota_pis, pgdasd_03130_valor_pis) 
            VALUES(:ID_Declaracao, :CNPJ, :Tipo, :Id, :Aliqapur, :Aliquota_COFINS, :Valor_COFINS, :Aliquota_CSLL, :Valor_CSLL, :Aliquota_ICMS, :Valor_ICMS, :Aliquota_INSS, :Valor_INSS, :Aliquota_IPI, :Valor_IPI, :Aliquota_IRPJ, :Valor_IRPJ, :Aliquota_ISS, :Valor_ISS, :Aliquota_PIS, :Valor_PIS)''',
            {'ID_Declaracao':pgdasd.Pgdasd_00000_ID_Declaracao, 'CNPJ':pgdasd.Pgdasd_03000[0].get('CNPJ'), 'Tipo':pgdasd.Pgdasd_03100[0].get('Tipo'), 'Id':lista['Id'], 'Aliqapur':lista['Aliqapur'], 'Aliquota_COFINS':lista['Aliquota_COFINS'], 'Valor_COFINS':lista['Valor_COFINS'], 'Aliquota_CSLL': lista['Aliquota_CSLL'], 'Valor_CSLL':lista['Valor_CSLL'], 'Aliquota_ICMS': lista['Aliquota_ICMS'], 'Valor_ICMS':lista['Valor_ICMS'], 'Aliquota_INSS':lista['Aliquota_INSS'], 'Valor_INSS':lista['Valor_INSS'], 'Aliquota_IPI':lista['Aliquota_IPI'], 'Valor_IPI':lista['Valor_IPI'], 'Aliquota_IRPJ':lista['Aliquota_IRPJ'], 'Valor_IRPJ':lista['Valor_IRPJ'], 'Aliquota_ISS':lista['Aliquota_ISS'], 'Valor_ISS':lista['Valor_ISS'], 'Aliquota_PIS':lista['Aliquota_PIS'], 'Valor_PIS':lista['Valor_PIS']})
            
            
        #cursor.execute('''INSERT INTO siatdesv.pgdasd_03131(PGDASD_00000_ID_DECLARACAO, pgdasd_03000_cnpj, pgdasd_03100_tipo, pgdasd_03130_id, pgdasd_03131_id, pgdasd_03131_aliqapur, pgdasd_03131_aliquota_cofins, pgdasd_03131_valor_cofins, pgdasd_03131_aliquota_csll, pgdasd_03131_valor_csll, pgdasd_03131_aliquota_icms, pgdasd_03131_valor_icms, pgdasd_03131_aliquota_inss, pgdasd_03131_valor_inss, pgdasd_03131_aliquota_ipi, pgdasd_03131_valor_ipi, pgdasd_03131_aliquota_irpj, pgdasd_03131_valor_irpj, pgdasd_03131_aliquota_iss, pgdasd_03131_valor_iss, pgdasd_03131_aliquota_pis, pgdasd_03131_valor_pis) 
        #VALUES(:ID_Declaracao, :CNPJ, :Tipo, :03130_Id, :Id, :Aliqapur, :Aliquota_COFINS, :Valor_COFINS, :Aliquota_CSLL, :Valor_CSLL, :Aliquota_ICMS, :Valor_ICMS, :Aliquota_INSS, Valor_INSS, :Aliquota_IPI, :Valor_IPI, :Aliquota_IRPJ, :Valor_IRPJ, :Aliquota_ISS,:Valor_ISS, :Aliquota_PIS, :Valor_PIS)''',
        #{'ID_Declaracao':pgdasd.Pgdasd_00000_ID_Declaracao, 'CNPJ':pgdasd.Pgdasd_03000.CNPJ, 'Tipo':pgdasd.Pgdasd_03000.Pgdasd_03100.Tipo, '03130_Id':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03130.Id, 'Id':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03130.Pgdasd_03131.Id, 'Aliqapur':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03130.Pgdasd_03131.Aliqapur, 'Aliquota_COFINS':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03130.Pgdasd_03131.Aliquota_COFINS, 'Valor_COFINS': pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03130.Pgdasd_03131.Valor_COFINS, 'Aliquota_CSLL':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03130.Pgdasd_03131.Aliquota_CSLL, 'Valor_CSLL':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03130.Pgdasd_03131.Valor_CSLL, 'Aliquota_ICMS':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03130.Pgdasd_03131.Aliquota_ICMS, 'Valor_ICMS':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03130.Pgdasd_03131.Valor_ICMS, 'Aliquota_INSS':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03130.Pgdasd_03131.Aliquota_INSS, 'Valor_INSS':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03130.Pgdasd_03131.Valor_INSS, 'Aliquota_IPI':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03130.Pgdasd_03131.Aliquota_IPI, 'Valor_IPI':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03130.Pgdasd_03131.Valor_IPI, 'Aliquota_IRPJ':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03130.Pgdasd_03131.Aliquota_IRPJ, 'Valor_IRPJ':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03130.Pgdasd_03131.Valor_IRPJ, 'Aliquota_ISS':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03130.Pgdasd_03131.Aliquota_ISS, 'Valor_ISS':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03130.Pgdasd_03131.Valor_ISS, 'Aliquota_PIS':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03130.Pgdasd_03131.Aliquota_PIS, 'Valor_PIS':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03130.Pgdasd_03131.Valor_PIS})

        #cursor.execute('''INSERT INTO siatdesv.pgdasd_03132(PGDASD_00000_ID_DECLARACAO, pgdasd_03000_cnpj, pgdasd_03100_tipo, pgdasd_03130_id, pgdasd_03132_id, pgdasd_03132_aliqapur, pgdasd_03132_aliquota_cofins, pgdasd_03132_valor_cofins, pgdasd_03132_aliquota_csll, pgdasd_03132_valor_csll, pgdasd_03132_aliquota_icms, pgdasd_03132_valor_icms, pgdasd_03132_aliquota_inss, pgdasd_03132_valor_inss, pgdasd_03132_aliquota_ipi, pgdasd_03132_valor_ipi, pgdasd_03132_aliquota_irpj, pgdasd_03132_valor_irpj, pgdasd_03132_aliquota_iss, pgdasd_03132_valor_iss, pgdasd_03132_aliquota_pis, pgdasd_03132_valor_pis) 
        #VALUES(:ID_Declaracao, :CNPJ, :Tipo, :03130_Id, :Id, :Aliqapur, :Aliquota_COFINS, :Valor_COFINS, :Aliquota_CSLL, :Valor_CSLL, :Aliquota_ICMS, :Valor_ICMS, :Aliquota_INSS, :Valor_INSS, :Aliquota_IPI, :Valor_IPI, :Aliquota_IRPJ, :Valor_IRPJ, :Aliquota_ISS, :Valor_ISS, :Aliquota_PIS, :Valor_PIS)''',
        #{'ID_Declaracao':pgdasd.Pgdasd_00000_ID_Declaracao, 'CNPJ':pgdasd.Pgdasd_03000.CNPJ, 'Tipo':pgdasd.Pgdasd_03000.Pgdasd_03100.Tipo, '03130_Id':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03130.Id, 'Id':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03130.Pgdasd_03132.Id, 'Aliqapur':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03130.Pgdasd_03132.Aliqapur, 'Aliquota_COFINS':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03130.Pgdasd_03132.Aliquota_COFINS, 'Valor_COFINS':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03130.Valor_COFINS, 'Aliquota_CSLL':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03130.Aliquota_CSLL, 'Valor_CSLL':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03130.Valor_CSLL, 'Aliquota_ICMS':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03130.Aliquota_ICMS, 'Valor_ICMS':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03130.Valor_ICMS, 'Aliquota_INSS':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03130.Aliquota_INSS, 'Valor_INSS':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03130.Valor_INSS, 'Aliquota_IPI':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03130.Aliquota_IPI, 'Valor_IPI':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03130.Valor_IPI, 'Aliquota_IRPJ':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03130.Aliquota_IRPJ, 'Valor_IRPJ':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03130.Valor_IRPJ, 'Aliquota_ISS':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03130.Aliquota_ISS, 'Valor_ISS':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03130.Valor_ISS, 'Aliquota_PIS':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03130.Aliquota_PIS, 'Valor_PIS':pgdasd.Pgdasd_03000.Pgdasd_03100.Pgdasd_03130.Valor_PIS})
            
        if pgdasd.Pgdasd_03500.fssn_PA != "" and pgdasd.Pgdasd_03500.fssn_valor != 0.0:
            cursor.execute('''INSERT INTO siatdesv.pgdasd_03500(PGDASD_00000_ID_DECLARACAO, pgdasd_03500_fssn_pa, pgdasd_03500_fssn_valor) 
            VALUES(:ID_Declaracao, :fssn_PA, :fssn_valor)''',
            {'ID_Declaracao':pgdasd.Pgdasd_00000_ID_Declaracao, 'fssn_PA':pgdasd.Pgdasd_03500.fssn_PA, 'fssn_valor':pgdasd.Pgdasd_03500.fssn_valor}) 

        cursor.execute('''INSERT INTO siatdesv.pgdasd_04000(PGDASD_00000_ID_DECLARACAO, pgdasd_04000_id, pgdasd_04000_codrecp, pgdasd_04000_valorprinc, pgdasd_04000_codrecm, pgdasd_04000_valorm, pgdasd_04000_codrecj, pgdasd_04000_valorj, pgdasd_04000_uf, pgdasd_04000_codmunic) 
        VALUES(:ID_Declaracao, :id, :codrecp, :valorprinc, :codrecm, :valorm, :codrecj, :valorj, :uf, :codmunic)''',
        {'ID_Declaracao':pgdasd.Pgdasd_00000_ID_Declaracao, 'id':pgdasd.Pgdasd_04000.Id, 'codrecp':pgdasd.Pgdasd_04000.codrecp, 'valorprinc':pgdasd.Pgdasd_04000.valorprinc, 'codrecm':pgdasd.Pgdasd_04000.codrecm, 'valorm':pgdasd.Pgdasd_04000.valorm, 'codrecj':pgdasd.Pgdasd_04000.codrecj, 'valorj':pgdasd.Pgdasd_04000.valorj, 'uf':pgdasd.Pgdasd_04000.uf, 'codmunic':pgdasd.Pgdasd_04000.codmunic})
            

        #conn.commit() #Se não houver erros realiza o commit
        #print("Commit")                        
        #except:
         #   conn.rollback() #Houve algum problema ao gravar - realiza o rollback
          #  print("Rollback")        
        cursor.close()
        conn.close()
        print("Importação concluída com sucesso!")
    
    def findAll(self, pgdasd):
        conn = oracle.ConnectionOracle()
        conn = conn.connect()
        cursor = conn.cursor()
        cursor.execute("select * from siatdesv.pgdasd where pgdasd_00000_id_declaracao = '02242675201203001'") # consulta sql
        result = cursor.fetchone()  # busca o resultado da consulta
        if result == None: 
            print ("Nenhum Resultado")
            exit
        else:
            while result:   
                print (result)
                result = cursor.fetchone()
        cursor.close()
        conn.close()        
        